<!-- Attacks - Melee -->
<div class='strikes melee background-color'>
    <h1 >attacks</h1>
    <fieldset class='repeating_melee-strikes'>
        <input name='attr_weapon_strike' type='hidden' value='0' />
        <input name='attr_weapon_display' type='hidden' value='+0' />
        <input name='attr_damage_display' type='hidden' value='0' />
        <input name='attr_damage_info' type='hidden' value='' />
        <input name='attr_damage_dice_query' type='hidden' value='@{damage_dice}' />
        <input name='attr_weapon_roll' type='hidden' value='{{roll01_name=^{attack}}} {{roll01=[[1d20cs>@{weapon_crit_range}cf1 + [@{weapon_proficiency_display}] @{weapon_strike}[@{text_modifier}] + (@{query_roll_bonus})[@{text_bonus}]]]}} {{roll01_type=attack}} {{roll01_info=@{weapon_traits}}} {{roll01_critical=1}}' />
        <input name='attr_critical_confirm' type="hidden" value='{{criticalconfirm_name=^{critical_confirm}}} {{criticalconfirm=[[1d20cs>@{weapon_crit_range}cf1 + [@{weapon_proficiency_display}] @{weapon_strike}[@{text_modifier}] + (@{query_roll_bonus})[@{text_bonus}]]]}} {{criticalconfirm_type=critical-damage}} {{criticalconfirm_info=@{weapon_traits}}}' />
		<input name='attr_damage_roll' type='hidden' value='{{roll02_name=^{damage}}} {{roll02=[[@{damage_dice_query}@{damage_dice_size} + @{damage_ability}[@{text_ability_modifier}] + @{damage_other}[OTHER] + @{query_roll_damage_bonus}[@{text_roll_damage_bonus}]]]}} {{roll02_type=damage}} {{roll02_info=@{damage_info}}}' />
        <input name='attr_damage_critical_roll' type='hidden' value='{{criticalroll_name=^{critical_damage}}} {{criticalroll=[[(@{damage_dice_query}*@{weapon_crit_mult})@{damage_dice_size} + @{damage_ability}[@{text_ability_modifier}] + @{damage_other}[OTHER] + @{query_roll_damage_bonus}[@{text_roll_damage_bonus}]]]}} {{criticalroll_type=critical-damage}} {{criticalroll_info=@{damage_info}}}' />
        <input name='attr_damage_additional_roll' type='hidden' value='{{roll04_name=^{damage_additional}}} {{roll04=@{damage_additional}}} {{roll04_type=damage}}' />
        <input name="attr_weapon_proficiency_display" type="hidden" value ="" />
        <!-- Optional Critical Damage handling -->
        <button name='roll_CRITICAL_DAMAGE' style='display: none;' type='roll' value='@{whispertype} &{template:rolls} {{limit_height=@{roll_limit_height}}} {{charactername=@{character_name}}} {{header=@{weapon}}} {{subheader=^{melee_strike}}} {{notes_show=@{roll_show_notes}}} {{notes=@{weapon_notes}}} @{damage_critical_roll}'></button>
        <input name='attr_roll_critical_damage_button' type='hidden' value='{{criticalrollmisc=[^{roll} ^{critical_damage}](~repeating_melee-strikes_CRITICAL_DAMAGE) }}' />
        <input name='attr_roll_critical_damage' type='hidden' value='@{damage_critical_roll}' />
        <!-- Show & hide hidden areas -->
        <input class='toggles' name='attr_toggles' type='hidden' value='display,settings,' />
        <div class='grid display'>
            <button class='pictos settings-button' name='act_settings' title='melee weapon settings' type='action'>
                y
            </button>
            <span class='sublabel darkred weapon' >weapon</span>
            <button class='display-weapon' name='roll_ATTACK-DAMAGE' title='weapon name display & attack and damage roll' type='roll'  value='@{whispertype} &{template:rolls} {{limit_height=@{roll_limit_height}}} {{charactername=@{character_name}}} {{header=@{weapon}}} {{subheader=^{melee_strike}}} {{notes_show=@{roll_show_notes}}} {{notes=@{weapon_notes}}} @{weapon_roll} @{critical_confirm} @{damage_roll} @{roll_critical_damage} @{damage_additional_roll}'>
                <span name='attr_weapon'></span>
            </button>
            <button name='act_collapse' title='show or hide weapon notes' type='action'>
                4
            </button>
            <span class='sublabel darkred attack' >atk</span>
            <span class='sublabel darkred damage' >damage</span>
            <button class='display-attack' name='roll_ATTACK' title='weapon attack display & attack only roll' type='roll' value='@{whispertype} &{template:rolls} {{limit_height=@{roll_limit_height}}} {{charactername=@{character_name}}} {{header=@{weapon}}} {{subheader=^{melee_strike}}} {{notes_show=@{roll_show_notes}}} {{notes=@{weapon_notes}}} @{weapon_roll} @{critical_confirm}'>
                <span class='weapon' name='attr_weapon_display'></span>
            </button>
            <button class='display-damage' name='roll_DAMAGE' title='weapon damage display & damage only roll' type='roll' value='@{whispertype} &{template:rolls} {{limit_height=@{roll_limit_height}}} {{charactername=@{character_name}}} {{header=@{weapon}}} {{subheader=^{melee_strike}}} {{notes_show=@{roll_show_notes}}} {{notes=@{weapon_notes}}} @{damage_roll} @{roll_critical_damage} @{damage_additional_roll}'>
                <span class='weapon' name='attr_damage_display'></span>
            </button>
            <span class='collapse' name='attr_weapon_notes'></span>
        </div>
        <div class='settings'>
            <div class='grid'>
                <h2 class="weapon_name">weapon</h2>
                <label title='melee weapon name'>
                    <input name='attr_weapon' placeholder='weapon' spellcheck='false' title='@{weapon}' type='text' value='' />
                </label>
            </div>
            <div class='grid strikes-grid'>
                <div class='circle'>
                    <span name='attr_weapon_strike' title='@{weapon_strike}'></span>
                </div>
                <span class='symbol'>=</span>	
                <div class='ability-select'>
                    <label title='melee weapon strike ability select'>
                        <select name='attr_weapon_ability_select' title='@{weapon_ability_select}'>
                            <option value='@{strength_modifier}' selected>str</option>
                            <option value='@{dexterity_modifier}'>dex</option>
                            <option value='@{constitution_modifier}'>con</option>
                            <option value='@{intelligence_modifier}'>int</option>
                            <option value='@{wisdom_modifier}'>wis</option>
                            <option value='@{charisma_modifier}'>cha</option>
                            <option value='custom'>custom</option>
                        </select>
                    </label>
                    <label title='melee weapon strike ability'>
                        <input name='attr_weapon_ability' placeholder='0' spellcheck='false' title='@{weapon_ability}' type='text' value='0' />
                    </label>
                </div>
                <label class='sublabel' title='melee weapon strike item'>
                    <span class='sublabel darkred' >item</span>
                    <input name='attr_weapon_item' placeholder='0' spellcheck='false' title='@{weapon_item}' type='text' value='0' />
                </label>
                <label class='sublabel' title='melee weapon strike temporary'>
                    <span class='sublabel darkred' >temp</span>
                    <input name='attr_weapon_temporary' placeholder='0' spellcheck='false' title='@{weapon_temporary}' type='text' value='0' />
                </label>
            </div>
			<div class="grid weapon-attributes">
				<label class='sublabel' title='melee weapon strike temporary'>
					<span class='sublabel darkred' >crit range</span>
					<input name='attr_weapon_crit_range' placeholder='0' spellcheck='false' title='@{weapon_crit_range}' type='text' value='20' />
				</label>
				<label class='sublabel' title='melee weapon strike temporary'>
					<span class='sublabel darkred' >crit mult</span>
					<input name='attr_weapon_crit_mult' placeholder='0' spellcheck='false' title='@{weapon_crit_mult}' type='text' value='2' />
				</label>
			</div>
            <div>
                <label title='melee weapon traits'>
                    <span class='sublabel darkred' >traits</span>
                    <input name='attr_weapon_traits' placeholder='traits' spellcheck='false' title='@{weapon_traits}' type='text' value='' />
                </label>
            </div>
            <div class='grid damage-grid'>
                <h2 >damage</h2>
                <label class='sublabel' title='melee weapon damage number of dice'>
                    <span class='sublabel darkred' >dice</span>
                    <input name='attr_damage_dice' placeholder='1' title='@{damage_dice}' type='number' value='1' />
                </label>
                <label class='sublabel' title='melee weapon damage die size'>
                    <span class='sublabel darkred' >size</span>
                    <input name='attr_damage_dice_size' placeholder='d6' spellcheck='false' title='@{damage_dice_size}' type='text' value='d6' />
                </label>
                <span class='symbol'>+</span>
                <div class='ability-select'>
                    <label title='melee weapon damage ability select'>
                        <select name='attr_damage_ability_select' title='@{damage_ability_select}'>
                            <option value='@{strength_modifier}' selected>str</option>
                            <option value='@{dexterity_modifier}'>dex</option>
                            <option value='@{constitution_modifier}'>con</option>
                            <option value='@{intelligence_modifier}'>int</option>
                            <option value='@{wisdom_modifier}'>wis</option>
                            <option value='@{charisma_modifier}'>cha</option>
                            <option value='custom'>custom</option>
                        </select>
                    </label>
                    <label title='melee weapon damage ability'>
                        <input name='attr_damage_ability' placeholder='0' spellcheck='false' title='@{damage_ability}' type='text' value='0' />
                    </label>
                </div>
                <label class='sublabel' title='melee weapon other damage'>
                    <span class='sublabel darkred' >other</span>
                    <input name='attr_damage_other' placeholder='0' spellcheck='false' title='@{damage_other}' type='text' value='0' />
                </label>
                <label title='melee weapon damage supplementary effects'>
                    <span class='sublabel darkred' >effects</span>
                    <input name='attr_damage_effects' placeholder='effects' spellcheck='false' title='@{damage_effects}' type='text' value='' />
                </label>
                <label title='melee attack additional damage'>
                    <span class='sublabel darkred' >additional damage</span>
                    <input name='attr_damage_additional' placeholder='[[1d6]] acid, [[1d6]] chaotic, and [[1d6]] evil, and [[2d6]] slashing vs. plants' spellcheck='false' title='@{damage_additional}' type='text' value='' />
                </label>
            </div>
            <h2 name="notes">Notes</h2>
            <label title='melee weapon notes'>
                <textarea name='attr_weapon_notes' placeholder='notes' spellcheck='false' title='@{weapon_notes}' value=''></textarea>
            </label>
        </div>
    </fieldset>
</div>